<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotina Familiar Dinâmica</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --accent-color: #4caf50;
            --highlight-bg: #2e7d32;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
            transition: all 0.5s ease;
        }

        /* Anti-Burn-in: Pequeno deslocamento randômico aplicado ao container principal */
        #main-container {
            display: flex;
            width: 100%;
            height: 100%;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
        }

        /* Coluna da Esquerda - Rotina (2/3) */
        #routine-panel {
            flex: 2;
            margin-right: 20px;
            overflow-y: auto;
            border-right: 1px solid #333;
            padding-right: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th, td {
            border: 1px solid #333;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #252525;
            position: sticky;
            top: 0;
        }

        /* Efeito de Piscado para Tarefa Atual */
        .active-task {
            background-color: var(--highlight-bg) !important;
            color: white;
            font-weight: bold;
            animation: pulse 2s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        /* Coluna da Direita - Relógios (1/3) */
        #clock-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
        }

        #digital-clock {
            font-size: 4rem;
            font-family: 'Courier New', Courier, monospace;
            color: var(--accent-color);
        }

        /* Relógio Analógico */
        #analog-clock {
            width: 250px;
            height: 250px;
            border: 8px solid var(--text-color);
            border-radius: 50%;
            position: relative;
            padding: 10px;
        }

        .hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom;
            background: var(--text-color);
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }

        .hour-hand { width: 6px; height: 60px; z-index: 3; }
        .min-hand { width: 4px; height: 90px; z-index: 2; }
        .second-hand { width: 2px; height: 100px; background: #ff5252; z-index: 1; }

        .center-dot {
            position: absolute;
            top: 50%; left: 50%;
            width: 12px; height: 12px;
            background: var(--accent-color);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 4;
        }
    </style>
</head>
<body>

<div id="main-container">
    <div id="routine-panel">
        <table id="routine-table">
            <thead>
                <tr>
                    <th>Horário</th>
                    <th>Babies</th>
                    <th>Cavalo</th>
                    <th>Mamãe</th>
                    <th>Papai</th>
                </tr>
            </thead>
            <tbody id="routine-body">
                </tbody>
        </table>
    </div>

    <div id="clock-panel">
        <div id="digital-clock">00:00:00</div>
        
        <div id="analog-clock">
            <div class="center-dot"></div>
            <div class="hand hour-hand" id="hour-hand"></div>
            <div class="hand min-hand" id="min-hand"></div>
            <div class="hand second-hand" id="sec-hand"></div>
        </div>
    </div>
</div>

<script>
    const data = [
        { h: "06:00-07:00", b: "Dormir", c: "Org. Pessoal", m: "Dormir", p: "Café da Manhã" },
        { h: "07:00-09:00", b: "Dormir", c: "CMT", m: "Dormir", p: "Translado CMT + Café" },
        { h: "09:00-10:00", b: "Café + Terapia", c: "CMT", m: "Café + Terapia", p: "Faxina" },
        { h: "10:00-11:00", b: "Terapia/Cativar", c: "CMT", m: "Terapia/Cativar", p: "Org. Terapia" },
        { h: "11:00-12:15", b: "Terapia/Cativar", c: "CMT", m: "Preparo Almoço", p: "Cativar" },
        { h: "12:15-13:00", b: "Org. Escola", c: "Cuidado Irmãs", m: "Almoço", p: "Translado Escola" },
        { h: "13:00-14:00", b: "Almoço + Translado", c: "Almoço/Descanso", m: "Almoço + Translado", p: "Almoço + Translado" },
        { h: "14:00-16:45", b: "Escola", c: "Cozinha/Estudo", m: "UNINASSAU", p: "IFMA" },
        { h: "16:45-18:00", b: "Translado + Celular", c: "Telas", m: "Translado Escolar", p: "Translado Escolar" },
        { h: "18:00-19:00", b: "TV", c: "Higiene Pessoal", m: "Preparo Jantar", p: "Supervisão Crianças" },
        { h: "19:00-20:00", b: "TV", c: "Leitura", m: "Jantar", p: "Jantar" },
        { h: "20:00-21:00", b: "Jantar", c: "Cozinha/Ritual", m: "Faxina + Novela", p: "Supervisão Crianças" },
        { h: "21:00-22:00", b: "Ritual Sono", c: "Ritual Sono", m: "BBB", p: "BBB" },
        { h: "22:00-23:00", b: "Dormir", c: "Dormir", m: "BBB", p: "BBB" },
        { h: "23:00-06:00", b: "Dormir", c: "Dormir", m: "Dormir", p: "Dormir" }
    ];

    function buildTable() {
        const body = document.getElementById('routine-body');
        data.forEach((row, index) => {
            const tr = document.createElement('tr');
            tr.id = `row-${index}`;
            tr.innerHTML = `
                <td>${row.h}</td>
                <td class="task-cell">${row.b}</td>
                <td class="task-cell">${row.c}</td>
                <td class="task-cell">${row.m}</td>
                <td class="task-cell">${row.p}</td>
            `;
            body.appendChild(tr);
        });
    }

    function updateClocks() {
        const now = new Date();
        const h = now.getHours();
        const m = now.getMinutes();
        const s = now.getSeconds();

        // Digital
        document.getElementById('digital-clock').innerText = 
            `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;

        // Analógico
        const sDeg = (s / 60) * 360;
        const mDeg = (m / 60) * 360 + (s / 60) * 6;
        const hDeg = (h / 12) * 360 + (m / 60) * 30;

        document.getElementById('sec-hand').style.transform = `translateX(-50%) rotate(${sDeg}deg)`;
        document.getElementById('min-hand').style.transform = `translateX(-50%) rotate(${mDeg}deg)`;
        document.getElementById('hour-hand').style.transform = `translateX(-50%) rotate(${hDeg}deg)`;

        highlightCurrentTask(h, m);
        applyAntiBurnIn(s);
    }

    function highlightCurrentTask(hour, min) {
        const currentTimeInMin = hour * 60 + min;

        data.forEach((range, index) => {
            const [start, end] = range.h.split('-').map(t => {
                const [h, m] = t.trim().split(':').map(Number);
                return h * 60 + m;
            });

            const row = document.getElementById(`row-${index}`);
            // Ajuste para horários que cruzam meia-noite (ex: 23:00-06:00)
            const isActive = (end < start) 
                ? (currentTimeInMin >= start || currentTimeInMin < end)
                : (currentTimeInMin >= start && currentTimeInMin < end);

            if (isActive) {
                row.querySelectorAll('.task-cell').forEach(cell => cell.classList.add('active-task'));
                // Auto-scroll para a tarefa ativa
                if (s === 0) row.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else {
                row.querySelectorAll('.task-cell').forEach(cell => cell.classList.remove('active-task'));
            }
        });
    }

    // Anti-Burn-In: Move o conteúdo levemente a cada minuto
    function applyAntiBurnIn(seconds) {
        if (seconds === 0) {
            const container = document.getElementById('main-container');
            const offX = Math.floor(Math.random() * 5); // 0 a 4px
            const offY = Math.floor(Math.random() * 5);
            container.style.transform = `translate(${offX}px, ${offY}px)`;
        }
    }

    let s = 0; // Variável auxiliar para o segundo no scroll
    setInterval(() => {
        s = new Date().getSeconds();
        updateClocks();
    }, 1000);

    buildTable();
    updateClocks();
</script>

</body>
</html>
